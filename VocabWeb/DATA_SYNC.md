# æ•°æ®åŒæ­¥è¯¦ç»†è¯´æ˜

## ğŸ”„ åŒæ­¥æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         VocabWeb                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  ç”µè„‘æµè§ˆå™¨      â”‚              â”‚   æ‰‹æœºæµè§ˆå™¨     â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚ LocalStorage    â”‚              â”‚ LocalStorage    â”‚       â”‚
â”‚  â”‚ - é…ç½®æ–‡ä»¶ âš™ï¸   â”‚              â”‚ - é…ç½®æ–‡ä»¶ âš™ï¸    â”‚       â”‚
â”‚  â”‚ - æ•°æ®åº“ç¼“å­˜ ğŸ’¾ â”‚              â”‚ - æ•°æ®åº“ç¼“å­˜ ğŸ’¾  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚           â”‚                                â”‚                â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                        â”‚                                    â”‚
â”‚                        â†“                                    â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚           â”‚   Flask æœåŠ¡å™¨ ğŸ–¥ï¸       â”‚                        â”‚
â”‚           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
â”‚           â”‚  user_vocab.db ğŸ’¿       â”‚                        â”‚
â”‚           â”‚  - è¯æ±‡è¡¨               â”‚                        â”‚
â”‚           â”‚  - ä¾‹å¥è¡¨               â”‚                        â”‚
â”‚           â”‚  - å­¦ä¹ è®°å½•             â”‚                        â”‚
â”‚           â”‚  - AIè®²è§£ç¼“å­˜           â”‚                        â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š æ•°æ®åˆ†ç±»

### 1. ä¼šåŒæ­¥åˆ°æœåŠ¡å™¨çš„æ•°æ®ï¼ˆSQLite æ•°æ®åº“ï¼‰

#### âœ… vocabulary (è¯æ±‡è¡¨)
```sql
CREATE TABLE vocabulary (
    id INTEGER PRIMARY KEY,
    word TEXT UNIQUE NOT NULL,      -- å•è¯
    meaning TEXT NOT NULL,           -- é‡Šä¹‰
    pos TEXT,                        -- è¯æ€§
    frequency INTEGER DEFAULT 0,     -- è¯é¢‘
    created_at DATETIME
);
```
**åŒæ­¥ç†ç”±**ï¼šæ‰€æœ‰è®¾å¤‡å…±äº«ç›¸åŒçš„è¯æ±‡åº“

#### âœ… sentences (ä¾‹å¥è¡¨)
```sql
CREATE TABLE sentences (
    id INTEGER PRIMARY KEY,
    word_id INTEGER NOT NULL,
    sentence TEXT NOT NULL,          -- ä¾‹å¥
    translation TEXT,                -- ç¿»è¯‘
    year INTEGER,                    -- å¹´ä»½
    question_number INTEGER,         -- é¢˜å·
    section_name TEXT,               -- é¢˜å‹åç§°
    -- ... å…¶ä»–å…ƒæ•°æ®
);
```
**åŒæ­¥ç†ç”±**ï¼šæ‰€æœ‰è®¾å¤‡çœ‹åˆ°ç›¸åŒçš„çœŸé¢˜ä¾‹å¥

#### âœ… learning_records (å­¦ä¹ è®°å½•)
```sql
CREATE TABLE learning_records (
    id INTEGER PRIMARY KEY,
    word_id INTEGER NOT NULL,
    sentence_id INTEGER NOT NULL,
    is_correct BOOLEAN,              -- æ˜¯å¦ç­”å¯¹
    repetition INTEGER DEFAULT 0,    -- é‡å¤æ¬¡æ•°
    easiness_factor REAL DEFAULT 2.5,-- éš¾åº¦ç³»æ•°
    interval INTEGER DEFAULT 0,      -- å¤ä¹ é—´éš”
    next_review DATETIME,            -- ä¸‹æ¬¡å¤ä¹ æ—¶é—´
    last_review DATETIME,            -- ä¸Šæ¬¡å¤ä¹ æ—¶é—´
    consecutive_correct INTEGER,     -- è¿ç»­ç­”å¯¹æ¬¡æ•°
    is_mistake BOOLEAN DEFAULT 0     -- æ˜¯å¦åœ¨é”™é¢˜æœ¬ä¸­
);
```
**åŒæ­¥ç†ç”±**ï¼šæ ¸å¿ƒå­¦ä¹ æ•°æ®ï¼Œå¿…é¡»è·¨è®¾å¤‡å…±äº«

#### âœ… explanations (AIè®²è§£ç¼“å­˜)
```sql
CREATE TABLE explanations (
    id INTEGER PRIMARY KEY,
    word_id INTEGER NOT NULL,
    sentence_id INTEGER NOT NULL,
    explanation TEXT NOT NULL,       -- AIç”Ÿæˆçš„è®²è§£
    created_at DATETIME
);
```
**åŒæ­¥ç†ç”±**ï¼šèŠ‚çœ API æˆæœ¬ï¼Œæ‰€æœ‰è®¾å¤‡å…±äº«ç¼“å­˜

---

### 2. ä¸ä¼šåŒæ­¥çš„æ•°æ®ï¼ˆLocalStorageï¼‰

#### âš™ï¸ ç”¨æˆ·é…ç½®
```javascript
// ä¿å­˜åœ¨ localStorageï¼Œkey æ ¼å¼: vocab_setting_{key}
{
    dailyGoal: "20",              // æ¯æ—¥å­¦ä¹ ç›®æ ‡
    sleepTime: "23:00",           // ç¡çœ æ—¶é—´ï¼ˆä¸€å¤©ç»“æŸæ—¶é—´ï¼‰
    notificationEnabled: "false", // æ˜¯å¦å¯ç”¨é€šçŸ¥
    notificationTime: "20:00",    // é€šçŸ¥æ—¶é—´
    geminiApiKey: ""              // Gemini API Key
}
```
**ä¸åŒæ­¥ç†ç”±**ï¼š
- ä¸åŒè®¾å¤‡æœ‰ä¸åŒçš„ä½¿ç”¨ä¹ æƒ¯
- ç”µè„‘å¯ä»¥è®¾ç½®æ¯æ—¥50ä¸ªï¼Œæ‰‹æœºè®¾ç½®20ä¸ª
- é€šçŸ¥æ—¶é—´å› è®¾å¤‡è€Œå¼‚
- API Key æ¯ä¸ªè®¾å¤‡å•ç‹¬ç®¡ç†

---

## ğŸ”„ åŒæ­¥æ—¶æœº

### è‡ªåŠ¨åŒæ­¥
| è§¦å‘äº‹ä»¶ | åŒæ­¥æ–¹å‘ | è¯´æ˜ |
|----------|---------|------|
| æ‰“å¼€é¡µé¢ | æœåŠ¡å™¨ â†’ æµè§ˆå™¨ | åŠ è½½æœ€æ–°å­¦ä¹ æ•°æ® |
| ç­”é¢˜å | æµè§ˆå™¨ â†’ æœåŠ¡å™¨ | ç«‹å³ä¿å­˜å­¦ä¹ è®°å½• |
| æ¯30ç§’ | æµè§ˆå™¨ â†’ æœåŠ¡å™¨ | å®šæ—¶è‡ªåŠ¨ä¿å­˜ |
| ç½‘ç»œæ¢å¤ | æµè§ˆå™¨ â†’ æœåŠ¡å™¨ | ç¦»çº¿æ•°æ®åŒæ­¥ |

### æ‰‹åŠ¨æ“ä½œ
| æ“ä½œ | å½±å“èŒƒå›´ | è¯´æ˜ |
|------|---------|------|
| ä¿®æ”¹é…ç½® | ä»…å½“å‰è®¾å¤‡ | ä¿å­˜åˆ° localStorage |
| æ¸…ç©ºæ•°æ®åº“ | æ‰€æœ‰è®¾å¤‡ | åˆ é™¤æœåŠ¡å™¨æ•°æ®åº“æ–‡ä»¶ |
| æ¸…é™¤ç¼“å­˜ | ä»…å½“å‰è®¾å¤‡ | åˆ é™¤ localStorage |

---

## ğŸ’¾ ä¿å­˜æœºåˆ¶

### 1. æ•°æ®åº“ä¿å­˜ï¼ˆå­¦ä¹ æ•°æ®ï¼‰

```javascript
// db.js
async save() {
    // 1. å¯¼å‡º SQLite æ•°æ®åº“
    const data = this.db.export();
    
    // 2. è½¬æ¢ä¸º Base64
    const base64 = btoa(binary);
    
    // 3. å‘é€åˆ°æœåŠ¡å™¨
    await fetch('/api/save-db', {
        method: 'POST',
        body: JSON.stringify({ database: base64 })
    });
    
    // 4. åŒæ—¶ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜
    localStorage.setItem('vocabDB', base64);
}
```

**è‡ªåŠ¨ä¿å­˜æ—¶æœº**ï¼š
- âœ… æ¯æ¬¡ç­”é¢˜åï¼ˆ`updateLearningRecord`ï¼‰
- âœ… æ·»åŠ è¯æ±‡åï¼ˆ`addWord`ï¼‰
- âœ… æ·»åŠ ä¾‹å¥åï¼ˆ`addSentence`ï¼‰
- âœ… AIè®²è§£ç¼“å­˜åï¼ˆ`addExplanation`ï¼‰
- âœ… æ¯30ç§’å®šæ—¶å™¨

### 2. é…ç½®ä¿å­˜ï¼ˆè®¾ç½®ï¼‰

```javascript
// db.js
setSetting(key, value) {
    // ä»…ä¿å­˜åˆ° localStorageï¼Œä¸åŒæ­¥
    localStorage.setItem(`vocab_setting_${key}`, value);
}

getSetting(key) {
    // ä» localStorage è¯»å–
    return localStorage.getItem(`vocab_setting_${key}`) || defaultValue;
}
```

**ä¿å­˜æ—¶æœº**ï¼š
- âœ… ç”¨æˆ·ä¿®æ”¹è®¾ç½®æ—¶ç«‹å³ä¿å­˜
- âŒ ä¸ä¼šåŒæ­¥åˆ°æœåŠ¡å™¨
- âŒ ä¸ä¼šå½±å“å…¶ä»–è®¾å¤‡

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šç”µè„‘å­¦ä¹ ï¼Œæ‰‹æœºå¤ä¹ 

```
1. ç”µè„‘æ‰“å¼€ http://localhost:8080
   â†“
2. ä»æœåŠ¡å™¨åŠ è½½æ•°æ®åº“ï¼ˆé¦–æ¬¡æ˜¯é¢„æ„å»ºæ•°æ®åº“ï¼‰
   â†“
3. å­¦ä¹  50 ä¸ªå•è¯ï¼Œæ¯æ¬¡ç­”é¢˜åè‡ªåŠ¨ä¿å­˜åˆ°æœåŠ¡å™¨
   â†“
4. æ‰‹æœºæ‰“å¼€ http://192.168.12.48:8080
   â†“
5. ä»æœåŠ¡å™¨åŠ è½½æ•°æ®åº“ï¼ˆåŒ…å«ç”µè„‘çš„å­¦ä¹ è®°å½•ï¼‰
   â†“
6. æ‰‹æœºæ˜¾ç¤ºï¼šå·²å­¦ä¹  50 ä¸ªå•è¯ï¼Œä»Šæ—¥å·²å®Œæˆ
   â†“
7. æ‰‹æœºç»§ç»­å­¦ä¹ ï¼Œè¿›åº¦åŒæ­¥å›æœåŠ¡å™¨
   â†“
8. ç”µè„‘åˆ·æ–°é¡µé¢ï¼Œçœ‹åˆ°æ‰‹æœºçš„æ–°è¿›åº¦
```

### åœºæ™¯ 2ï¼šä¸åŒè®¾å¤‡ç‹¬ç«‹é…ç½®

```
ç”µè„‘é…ç½®ï¼š
  - dailyGoal: 50
  - notificationTime: 20:00
  â†“
æ‰‹æœºé…ç½®ï¼š
  - dailyGoal: 20
  - notificationTime: 12:00
  â†“
ä¸¤ä¸ªè®¾å¤‡ç‹¬ç«‹é…ç½®ï¼Œä½†å­¦ä¹ æ•°æ®å®Œå…¨åŒæ­¥
```

### åœºæ™¯ 3ï¼šç¦»çº¿ä½¿ç”¨

```
1. åœ¨çº¿æ—¶ï¼šæ•°æ®è‡ªåŠ¨åŒæ­¥åˆ°æœåŠ¡å™¨
   â†“
2. ç½‘ç»œæ–­å¼€ï¼šä½¿ç”¨ LocalStorage ç¼“å­˜
   â†“
3. ç»§ç»­ç­”é¢˜ï¼šæ•°æ®ä¿å­˜åˆ°æœ¬åœ°
   â†“
4. ç½‘ç»œæ¢å¤ï¼šè‡ªåŠ¨åŒæ­¥åˆ°æœåŠ¡å™¨
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. é…ç½®æ–‡ä»¶
- âœ… æ¯ä¸ªè®¾å¤‡é¦–æ¬¡æ‰“å¼€ä¼šä½¿ç”¨é»˜è®¤é…ç½®
- âœ… å»ºè®®æ ¹æ®è®¾å¤‡ç±»å‹è°ƒæ•´é…ç½®
- âŒ é…ç½®ä¸ä¼šåœ¨è®¾å¤‡é—´åŒæ­¥

### 2. API Key
- âœ… å»ºè®®æ‰€æœ‰è®¾å¤‡ä½¿ç”¨ç›¸åŒçš„ Gemini API Key
- âœ… è¿™æ ·å¯ä»¥å…±äº« AI è®²è§£ç¼“å­˜
- âš™ï¸ éœ€è¦åœ¨æ¯ä¸ªè®¾å¤‡å•ç‹¬è®¾ç½®

### 3. æ•°æ®åº“æ–‡ä»¶
- ğŸ“ æœåŠ¡å™¨ç«¯ï¼š`user_vocab.db`ï¼ˆä¸»æ•°æ®ï¼‰
- ğŸ“ è‡ªåŠ¨å¤‡ä»½ï¼š`user_vocab.db.backup`
- ğŸ’¾ æµè§ˆå™¨ç«¯ï¼šLocalStorage `vocabDB`ï¼ˆç¼“å­˜ï¼‰

### 4. åŒæ­¥å†²çª
- âœ… æ¯æ¬¡æ‰“å¼€é¡µé¢æ—¶ä»æœåŠ¡å™¨åŠ è½½æœ€æ–°æ•°æ®
- âœ… åæäº¤çš„æ•°æ®ä¼šè¦†ç›–å…ˆå‰çš„
- âš ï¸ å»ºè®®ä¸è¦åœ¨å¤šä¸ªè®¾å¤‡åŒæ—¶å­¦ä¹ 

---

## ğŸ› ï¸ è°ƒè¯•å·¥å…·

### æŸ¥çœ‹åŒæ­¥çŠ¶æ€
è®¿é—®ï¼šhttp://localhost:8080/test.html

### æµè§ˆå™¨æ§åˆ¶å°å‘½ä»¤

```javascript
// æŸ¥çœ‹æ•°æ®åº“å¤§å°
console.log(localStorage.getItem('vocabDB').length);

// æŸ¥çœ‹æ‰€æœ‰é…ç½®
['dailyGoal', 'sleepTime', 'notificationEnabled', 'notificationTime'].forEach(key => {
    console.log(key, localStorage.getItem(`vocab_setting_${key}`));
});

// å¼ºåˆ¶åŒæ­¥åˆ°æœåŠ¡å™¨
db.saveToServer();

// ä»æœåŠ¡å™¨é‡æ–°åŠ è½½
location.reload();
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [CONFIG.md](CONFIG.md) - é…ç½®æ–‡ä»¶è¯¦ç»†è¯´æ˜
- [SYNC_GUIDE.md](SYNC_GUIDE.md) - è·¨è®¾å¤‡åŒæ­¥æŒ‡å—
- [README.md](README.md) - é¡¹ç›®æ€»è§ˆ
